<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="description" content="æ— éšœç¢AIå­¦ä¹ å¹³å° - è¯¾ç¨‹é€‰æ‹©">
    <title>è¯¾ç¨‹é€‰æ‹© - æ— éšœç¢AIå­¦ä¹ å¹³å°</title>

    <style>
        /* ==================== åŸºç¡€æ ·å¼ ==================== */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --text-primary: #212121;
            --text-secondary: #666666;
            --accent-color: #1a73e8;
            --success-color: #34a853;
            --disabled-color: #cccccc;
            --border-color: #e0e0e0;

            --font-size-base: 16px;
            --font-scale: 1;

            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC",
                         "Microsoft YaHei", sans-serif;
            font-size: var(--font-size-base);
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--bg-secondary);
            min-height: 100vh;
        }

        /* ==================== é¡¶éƒ¨å¯¼èˆªæ  - çº¿æ€§å¸ƒå±€ ==================== */
        .top-nav {
            background-color: var(--accent-color);
            color: white;
            padding: var(--spacing-lg);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: var(--spacing-md);
            text-align: center;
        }

        .user-mode-badge {
            background-color: rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 16px;
            display: block;
            text-align: center;
            margin-bottom: var(--spacing-lg);
        }

        .nav-buttons {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            max-width: 600px;
            margin: 0 auto;
        }

        .nav-btn {
            background-color: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 16px 24px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 56px;
            text-align: left;
            width: 100%;
        }

        .nav-btn:hover {
            background-color: rgba(255,255,255,0.3);
            transform: translateX(4px);
        }

        .nav-btn:focus {
            outline: 3px solid white;
            outline-offset: 2px;
        }

        /* ==================== ä¸»å®¹å™¨ ==================== */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--spacing-xl) var(--spacing-md);
        }

        .page-header {
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }

        .page-title {
            font-size: 32px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .page-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
        }

        /* ==================== è¯¾ç¨‹ç½‘æ ¼ ==================== */
        /* ==================== è¯¾ç¨‹åˆ—è¡¨ - çº¿æ€§å¸ƒå±€ ==================== */
        .course-grid {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        /* ==================== è¯¾ç¨‹å¡ç‰‡ - ç®€åŒ–å¸ƒå±€ ==================== */
        .course-card {
            background-color: var(--bg-primary);
            border: 3px solid var(--border-color);
            border-radius: 12px;
            padding: var(--spacing-lg);
            transition: border-color 0.2s;
        }

        .course-card:hover {
            border-color: var(--accent-color);
        }

        .course-card:focus-within {
            border-color: var(--accent-color);
            outline: 3px solid var(--accent-color);
            outline-offset: 2px;
        }

        .course-card.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .course-thumbnail {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            border-radius: 8px;
            margin-bottom: var(--spacing-md);
            position: relative;
        }

        .course-card:nth-child(2) .course-thumbnail {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .course-card:nth-child(3) .course-thumbnail {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .coming-soon-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .course-content {
            /* å†…å®¹å·²ç»åœ¨å¡ç‰‡å†…éƒ¨ï¼Œä¸éœ€è¦é¢å¤–padding */
        }

        .course-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .course-description {
            font-size: 16px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: var(--spacing-md);
        }

        /* è¯¾ç¨‹å…ƒä¿¡æ¯ - å‚ç›´çº¿æ€§å¸ƒå±€ */
        .course-meta {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-md);
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
            color: var(--text-secondary);
        }

        .course-button {
            width: 100%;
            padding: var(--spacing-md);
            font-size: 16px;
            font-weight: 600;
            color: white;
            background-color: var(--accent-color);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 48px;
        }

        .course-button:hover {
            background-color: #1557b0;
            transform: translateY(-2px);
        }

        .course-button:disabled {
            background-color: var(--disabled-color);
            cursor: not-allowed;
            transform: none;
        }

        .course-button.completed {
            background-color: var(--success-color);
            border: 3px solid var(--success-color);
        }

        .course-button.completed:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        /* ==================== æ·»åŠ è¯¾ç¨‹å¡ç‰‡ï¼ˆæ•™å¸ˆæ¨¡å¼ï¼‰ - çº¿æ€§å¸ƒå±€ ==================== */
        .add-course-card {
            background-color: var(--bg-primary);
            border: 3px dashed #999999;
            border-radius: 12px;
            padding: var(--spacing-lg);
            transition: border-color 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-md);
        }

        .add-course-card:hover {
            border-color: var(--accent-color);
        }

        .add-course-icon {
            font-size: 64px;
            color: #999999;
            font-weight: 300;
        }

        .add-course-text {
            font-size: 20px;
            font-weight: 600;
            color: var(--accent-color);
            background: none;
            border: 2px solid var(--accent-color);
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
            max-width: 300px;
        }

        .add-course-text:hover {
            background-color: var(--accent-color);
            color: white;
        }

        .add-course-text:focus {
            outline: 3px solid var(--accent-color);
            outline-offset: 2px;
        }
            color: #666666;
            font-weight: 600;
        }

        /* ==================== å“åº”å¼è®¾è®¡ ==================== */
        @media (max-width: 768px) {
            .course-grid {
                grid-template-columns: 1fr;
            }

            .page-title {
                font-size: 24px;
            }

            .page-subtitle {
                font-size: 16px;
            }
        }

        /* ==================== ç„¦ç‚¹å¯è§æ€§ ==================== */
        *:focus-visible {
            outline: 3px solid var(--accent-color);
            outline-offset: 2px;
        }

        /* ==================== å¬éšœæ¨¡å¼æ ·å¼è¦†ç›–ï¼ˆç½‘æ ¼å¸ƒå±€ï¼‰ ==================== */
        body.hearing-mode .top-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-md) var(--spacing-lg);
        }

        body.hearing-mode .nav-title {
            font-size: 28px;
            margin-bottom: 0;
            text-align: left;
            flex-shrink: 0;
        }

        body.hearing-mode .user-mode-badge {
            position: absolute;
            top: var(--spacing-sm);
            right: var(--spacing-lg);
            margin-bottom: 0;
        }

        body.hearing-mode .nav-buttons {
            display: flex;
            flex-direction: row;
            gap: var(--spacing-md);
            margin: 0;
            max-width: none;
            margin-left: auto;
            padding-right: 150px;
        }

        body.hearing-mode .nav-btn {
            width: auto;
            min-width: 140px;
            padding: 12px 20px;
            font-size: 16px;
            min-height: 48px;
        }

        body.hearing-mode .nav-btn:hover {
            transform: translateY(-2px);
        }

        /* è¯¾ç¨‹ç½‘æ ¼ - ç½‘æ ¼å¸ƒå±€ */
        body.hearing-mode .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--spacing-lg);
            max-width: 1200px;
        }

        /* è¯¾ç¨‹å¡ç‰‡ - ç´§å‡‘æ ·å¼ */
        body.hearing-mode .course-card {
            display: flex;
            flex-direction: column;
            padding: var(--spacing-md);
            cursor: pointer;
        }

        body.hearing-mode .course-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-color: var(--accent-color);
        }

        body.hearing-mode .course-thumbnail {
            font-size: 48px;
            text-align: center;
            margin-bottom: var(--spacing-sm);
        }

        body.hearing-mode .course-title {
            font-size: 18px;
            margin-bottom: var(--spacing-sm);
        }

        body.hearing-mode .course-description {
            font-size: 14px;
            margin-bottom: var(--spacing-md);
            flex-grow: 1;
        }

        body.hearing-mode .course-meta {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-md);
        }

        body.hearing-mode .meta-item {
            font-size: 13px;
        }

        body.hearing-mode .course-button {
            padding: 10px 16px;
            font-size: 15px;
            min-height: 42px;
        }

    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  - çº¿æ€§å¸ƒå±€ -->
    <nav class="top-nav" role="navigation" aria-label="ä¸»å¯¼èˆª">
        <div class="nav-title" role="heading" aria-level="1">æ— éšœç¢AIå­¦ä¹ å¹³å°</div>
        <div class="user-mode-badge" id="userModeBadge" role="status">è§†éšœç”¨æˆ·æ¨¡å¼</div>

        <!-- å¯¼èˆªæŒ‰é’®ç»„ - å‚ç›´æ’åˆ— -->
        <div class="nav-buttons" role="group" aria-label="å¯¼èˆªæŒ‰é’®">
            <button class="nav-btn" id="returnBtn" aria-label="è¿”å›é¦–é¡µ">
                â† è¿”å›é¦–é¡µ
            </button>
            <button class="nav-btn" id="homeworkBtn" aria-label="æŸ¥çœ‹æˆ‘çš„ä½œä¸š">
                ğŸ“ æŸ¥çœ‹æˆ‘çš„ä½œä¸š
            </button>
            <button class="nav-btn" id="assignHomeworkBtn" aria-label="å¸ƒç½®ä½œä¸š" style="display: none;">
                ğŸ“‹ å¸ƒç½®ä½œä¸š
            </button>
        </div>
    </nav>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- é¡µé¢å¤´éƒ¨ -->
        <header class="page-header">
            <h1 class="page-title">é€‰æ‹©æ‚¨æƒ³å­¦ä¹ çš„è¯¾ç¨‹</h1>
            <p class="page-subtitle">æˆ‘ä»¬ä¸ºæ‚¨å‡†å¤‡äº†å¤šä¸ªAIå­¦ä¹ è¯¾ç¨‹ï¼Œä»åŸºç¡€åˆ°è¿›é˜¶</p>
        </header>

        <!-- è¯¾ç¨‹åˆ—è¡¨ -->
        <div class="course-grid" role="list" aria-label="å¯é€‰è¯¾ç¨‹åˆ—è¡¨">
            <!-- è¯¾ç¨‹1ï¼šAIåŠ©æ‰‹åŸºç¡€å…¥é—¨ -->
            <article class="course-card" id="course1" data-course-id="1" role="listitem">
                <div class="course-thumbnail" aria-hidden="true">ğŸ¤–</div>
                <h2 class="course-title">è¯¾ç¨‹1ï¼šAIåŠ©æ‰‹åŸºç¡€å…¥é—¨</h2>
                <p class="course-description">
                    å­¦ä¹ å¦‚ä½•ä½¿ç”¨AIåŠ©æ‰‹è¿›è¡Œæ—¥å¸¸å¯¹è¯ã€æé—®å’Œè·å–å¸®åŠ©ã€‚é€‚åˆé›¶åŸºç¡€ç”¨æˆ·ã€‚
                </p>
                <div class="course-meta" role="list" aria-label="è¯¾ç¨‹ä¿¡æ¯">
                    <div class="meta-item" role="listitem">
                        <span aria-hidden="true">â±ï¸</span>
                        <span>å­¦ä¹ æ—¶é•¿ï¼šçº¦30åˆ†é’Ÿ</span>
                    </div>
                    <div class="meta-item" role="listitem">
                        <span aria-hidden="true">ğŸ“š</span>
                        <span>ä»»åŠ¡æ•°é‡ï¼š5ä¸ªä»»åŠ¡</span>
                    </div>
                </div>
                <button class="course-button" aria-label="å¼€å§‹å­¦ä¹ AIåŠ©æ‰‹åŸºç¡€å…¥é—¨è¯¾ç¨‹">
                    å¼€å§‹å­¦ä¹ 
                </button>
            </article>

            <!-- è¯¾ç¨‹2ï¼šè§†é¢‘æ•™å­¦è¯¾ç¨‹ -->
            <article class="course-card" id="course2" data-course-id="2" role="listitem">
                <div class="course-thumbnail" aria-hidden="true">ğŸ¬</div>
                <h2 class="course-title">è¯¾ç¨‹2ï¼šè§†é¢‘æ•™å­¦è¯¾ç¨‹ï¼ˆå¸¦å­—å¹•ï¼‰</h2>
                <p class="course-description">
                    é€šè¿‡è§†é¢‘å­¦ä¹ AIçŸ¥è¯†ï¼Œé…å¤‡å®Œæ•´çš„ä¸­æ–‡å­—å¹•ï¼Œé€‚åˆå¬éšœç”¨æˆ·å­¦ä¹ ã€‚
                </p>
                <div class="course-meta" role="list" aria-label="è¯¾ç¨‹ä¿¡æ¯">
                    <div class="meta-item" role="listitem">
                        <span aria-hidden="true">â±ï¸</span>
                        <span>å­¦ä¹ æ—¶é•¿ï¼šçº¦20åˆ†é’Ÿ</span>
                    </div>
                    <div class="meta-item" role="listitem">
                        <span aria-hidden="true">ğŸ“š</span>
                        <span>è¯¾ç¨‹ç±»å‹ï¼šè§†é¢‘+å­—å¹•</span>
                    </div>
                </div>
                <button class="course-button" aria-label="å¼€å§‹å­¦ä¹ è§†é¢‘æ•™å­¦è¯¾ç¨‹">
                    å¼€å§‹å­¦ä¹ 
                </button>
            </article>

            <!-- è¯¾ç¨‹3ï¼šAIå›¾åƒç”Ÿæˆ -->
            <article class="course-card disabled" id="course3" data-course-id="3" role="listitem">
                <div class="course-thumbnail" aria-hidden="true">
                    ğŸ¨
                    <span class="coming-soon-badge">å³å°†æ¨å‡º</span>
                </div>
                <h2 class="course-title">è¯¾ç¨‹3ï¼šAIå›¾åƒç”Ÿæˆ</h2>
                <p class="course-description">
                    å­¦ä¹ å¦‚ä½•ä½¿ç”¨AIç”Ÿæˆå›¾åƒï¼ŒåŒ…æ‹¬æè¿°å›¾åƒã€è°ƒæ•´é£æ ¼ç­‰æŠ€å·§ã€‚
                </p>
                <div class="course-meta" role="list" aria-label="è¯¾ç¨‹ä¿¡æ¯">
                    <div class="meta-item" role="listitem">
                        <span aria-hidden="true">â±ï¸</span>
                        <span>å­¦ä¹ æ—¶é•¿ï¼šçº¦60åˆ†é’Ÿ</span>
                    </div>
                    <div class="meta-item" role="listitem">
                        <span aria-hidden="true">ğŸ“š</span>
                        <span>ä»»åŠ¡æ•°é‡ï¼š8ä¸ªä»»åŠ¡</span>
                    </div>
                </div>
                <button class="course-button" disabled aria-label="AIå›¾åƒç”Ÿæˆè¯¾ç¨‹å³å°†æ¨å‡ºï¼Œæš‚æ—¶æ— æ³•å­¦ä¹ ">
                    å³å°†æ¨å‡º
                </button>
            </article>

            <!-- æ·»åŠ è¯¾ç¨‹å¡ç‰‡ï¼ˆä»…æ•™å¸ˆæ¨¡å¼æ˜¾ç¤ºï¼‰ -->
            <article class="add-course-card" id="addCourseCard" style="display: none;" role="listitem">
                <div class="add-course-icon" aria-hidden="true">+</div>
                <button class="add-course-text" aria-label="åˆ›å»ºæ–°è¯¾ç¨‹">
                    æ·»åŠ æ–°è¯¾ç¨‹
                </button>
            </article>
        </div>
    </div>

    <script>
        // ==================== ç”¨æˆ·æ¨¡å¼æ£€æµ‹ä¸åˆå§‹åŒ– ====================
        // è·å–URLå‚æ•°
        const urlParams = new URLSearchParams(window.location.search);
        let userMode = urlParams.get('mode');

        // å¦‚æœURLå‚æ•°ä¸å­˜åœ¨ï¼Œåˆ™ä»localStorageè¯»å–
        if (!userMode || userMode === '') {
            userMode = localStorage.getItem('userMode') || 'visual';
        }

        // è°ƒè¯•ä¿¡æ¯ï¼ˆå¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹ï¼‰
        console.log('=== è¯¾ç¨‹é€‰æ‹©é¡µé¢ - ç”¨æˆ·æ¨¡å¼æ£€æµ‹ ===');
        console.log('URLå‚æ•°:', window.location.search);
        console.log('æ£€æµ‹åˆ°çš„ç”¨æˆ·æ¨¡å¼:', userMode);

        // ä¿å­˜ç”¨æˆ·æ¨¡å¼åˆ°localStorage
        localStorage.setItem('userMode', userMode);

        // æ›´æ–°ç”¨æˆ·æ¨¡å¼æ˜¾ç¤º
        const userModeBadge = document.getElementById('userModeBadge');
        const assignHomeworkBtn = document.getElementById('assignHomeworkBtn');
        const addCourseCard = document.getElementById('addCourseCard');
        const homeworkBtn = document.getElementById('homeworkBtn');

        // æ ¹æ®ç”¨æˆ·æ¨¡å¼é…ç½®ç•Œé¢
        if (userMode === 'teacher') {
            console.log('é…ç½®æ•™å¸ˆæ¨¡å¼ç•Œé¢...');
            userModeBadge.textContent = 'æ•™å¸ˆæ¨¡å¼';
            // æ˜¾ç¤ºæ•™å¸ˆä¸“ç”¨æŒ‰é’®å’Œå¡ç‰‡
            if (assignHomeworkBtn) assignHomeworkBtn.style.display = 'block';
            if (addCourseCard) addCourseCard.style.display = 'flex';
            // éšè—å­¦ç”Ÿä½œä¸šæŒ‰é’®
            if (homeworkBtn) homeworkBtn.style.display = 'none';
        } else if (userMode === 'hearing') {
            console.log('é…ç½®å¬éšœç”¨æˆ·æ¨¡å¼ç•Œé¢...');
            userModeBadge.textContent = 'å¬éšœç”¨æˆ·æ¨¡å¼';
            document.body.classList.add('hearing-mode');
            // éšè—æ•™å¸ˆä¸“ç”¨æŒ‰é’®å’Œå¡ç‰‡
            if (assignHomeworkBtn) assignHomeworkBtn.style.display = 'none';
            if (addCourseCard) addCourseCard.style.display = 'none';
            // æ˜¾ç¤ºå­¦ç”Ÿä½œä¸šæŒ‰é’®
            if (homeworkBtn) homeworkBtn.style.display = 'block';
        } else {
            console.log('é…ç½®è§†éšœç”¨æˆ·æ¨¡å¼ç•Œé¢...');
            userModeBadge.textContent = 'è§†éšœç”¨æˆ·æ¨¡å¼';
            document.body.classList.add('visual-mode');
            // éšè—æ•™å¸ˆä¸“ç”¨æŒ‰é’®å’Œå¡ç‰‡
            if (assignHomeworkBtn) assignHomeworkBtn.style.display = 'none';
            if (addCourseCard) addCourseCard.style.display = 'none';
            // æ˜¾ç¤ºå­¦ç”Ÿä½œä¸šæŒ‰é’®
            if (homeworkBtn) homeworkBtn.style.display = 'block';
        }

        // ==================== åŠ¨æ€åŠ è½½è¯¾ç¨‹ ====================
        async function loadCoursesFromAPI() {
            try {
                const response = await fetch('http://localhost:3000/api/courses');
                const result = await response.json();

                if (result.success && result.courses) {
                    // è·å–è¯¾ç¨‹ç½‘æ ¼å®¹å™¨
                    const courseGrid = document.querySelector('.course-grid');

                    // æ¸²æŸ“ä»APIè·å–çš„è¯¾ç¨‹ï¼ˆè·³è¿‡ç¬¬ä¸€ä¸ªç¤ºä¾‹è¯¾ç¨‹ï¼Œå› ä¸ºå®ƒå·²ç»ç¡¬ç¼–ç äº†ï¼‰
                    result.courses.slice(1).forEach(course => {
                        renderCourseCard(course, courseGrid);
                    });
                }
            } catch (error) {
                console.error('åŠ è½½è¯¾ç¨‹å¤±è´¥:', error);
                // å¦‚æœåç«¯æœªå¯åŠ¨ï¼Œé™é»˜å¤±è´¥ï¼Œä½¿ç”¨ç¡¬ç¼–ç çš„è¯¾ç¨‹
            }
        }

        // æ¸²æŸ“è¯¾ç¨‹å¡ç‰‡
        function renderCourseCard(course, container) {
            const article = document.createElement('article');
            article.className = 'course-card';
            article.setAttribute('data-course-id', course.id);
            article.setAttribute('role', 'listitem');

            const taskCount = course.tasks ? course.tasks.length : 0;

            // æ£€æŸ¥è¯¾ç¨‹æ˜¯å¦å·²å®Œæˆ
            const completedCourses = JSON.parse(localStorage.getItem('completedCourses') || '[]');
            const isCompleted = completedCourses.includes(course.id);

            const buttonClass = isCompleted ? 'course-button completed' : 'course-button';
            const buttonText = isCompleted ? 'âœ“ å·²å®Œæˆ' : 'å¼€å§‹å­¦ä¹ ';
            const buttonLabel = isCompleted ? `${course.title}è¯¾ç¨‹å·²å®Œæˆï¼Œç‚¹å‡»é‡æ–°å­¦ä¹ ` : `å¼€å§‹å­¦ä¹ ${course.title}è¯¾ç¨‹`;

            article.innerHTML = `
                <div class="course-thumbnail" aria-hidden="true">ğŸ“</div>
                <h2 class="course-title">è¯¾ç¨‹ï¼š${course.title}</h2>
                <p class="course-description">
                    ${course.description}
                </p>
                <div class="course-meta" role="list" aria-label="è¯¾ç¨‹ä¿¡æ¯">
                    <div class="meta-item" role="listitem">
                        <span aria-hidden="true">ğŸ“š</span>
                        <span>ä»»åŠ¡æ•°é‡ï¼š${taskCount}ä¸ªä»»åŠ¡</span>
                    </div>
                </div>
                <button class="${buttonClass}" aria-label="${buttonLabel}">
                    ${buttonText}
                </button>
            `;

            // æ·»åŠ ç‚¹å‡»äº‹ä»¶
            article.addEventListener('click', function() {
                if (userMode === 'teacher') {
                    window.location.href = `teacher_dashboard.html?action=edit&courseId=${course.id}`;
                } else {
                    // å­¦ç”Ÿæ¨¡å¼ï¼šè·³è½¬åˆ°ç»Ÿä¸€çš„è¯¾ç¨‹å­¦ä¹ é¡µé¢
                    window.location.href = `course_learning.html?courseId=${course.id}&mode=${userMode}`;
                }
            });

            // æ’å…¥åˆ°"æ·»åŠ è¯¾ç¨‹"å¡ç‰‡ä¹‹å‰
            const addCourseCard = document.getElementById('addCourseCard');
            if (addCourseCard) {
                container.insertBefore(article, addCourseCard);
            } else {
                container.appendChild(article);
            }
        }

        // æ›´æ–°é™æ€è¯¾ç¨‹å¡ç‰‡çš„å®ŒæˆçŠ¶æ€
        function updateStaticCourseCards() {
            const completedCourses = JSON.parse(localStorage.getItem('completedCourses') || '[]');

            // æ›´æ–°è¯¾ç¨‹1
            if (completedCourses.includes('course_001')) {
                const course1Btn = document.querySelector('#course1 .course-button');
                if (course1Btn) {
                    course1Btn.classList.add('completed');
                    course1Btn.textContent = 'âœ“ å·²å®Œæˆ';
                    course1Btn.setAttribute('aria-label', 'AIåŠ©æ‰‹åŸºç¡€å…¥é—¨è¯¾ç¨‹å·²å®Œæˆï¼Œç‚¹å‡»é‡æ–°å­¦ä¹ ');
                }
            }

            // æ›´æ–°è¯¾ç¨‹2
            if (completedCourses.includes('course_002')) {
                const course2Btn = document.querySelector('#course2 .course-button');
                if (course2Btn) {
                    course2Btn.classList.add('completed');
                    course2Btn.textContent = 'âœ“ å·²å®Œæˆ';
                    course2Btn.setAttribute('aria-label', 'è§†é¢‘æ•™å­¦è¯¾ç¨‹å·²å®Œæˆï¼Œç‚¹å‡»é‡æ–°å­¦ä¹ ');
                }
            }

            // æ›´æ–°è¯¾ç¨‹3
            if (completedCourses.includes('course_003')) {
                const course3Btn = document.querySelector('#course3 .course-button');
                if (course3Btn) {
                    course3Btn.classList.add('completed');
                    course3Btn.textContent = 'âœ“ å·²å®Œæˆ';
                    course3Btn.setAttribute('aria-label', 'é«˜çº§AIåº”ç”¨è¯¾ç¨‹å·²å®Œæˆï¼Œç‚¹å‡»é‡æ–°å­¦ä¹ ');
                }
            }
        }

        // é¡µé¢åŠ è½½æ—¶è·å–è¯¾ç¨‹
        loadCoursesFromAPI();

        // æ›´æ–°é™æ€è¯¾ç¨‹å¡ç‰‡çš„å®ŒæˆçŠ¶æ€
        updateStaticCourseCards();

        // è¯¾ç¨‹1ç‚¹å‡»äº‹ä»¶
        document.getElementById('course1').addEventListener('click', function() {
            if (userMode === 'teacher') {
                // æ•™å¸ˆæ¨¡å¼ï¼šè·³è½¬åˆ°è¯¾ç¨‹ç¼–è¾‘é¡µé¢
                window.location.href = 'teacher_dashboard.html?action=edit&courseId=course_001';
            } else {
                // å­¦ç”Ÿæ¨¡å¼ï¼šè·³è½¬åˆ°ç»Ÿä¸€çš„è¯¾ç¨‹å­¦ä¹ é¡µé¢
                window.location.href = `course_learning.html?courseId=course_001&mode=${userMode}`;
            }
        });

        // è¯¾ç¨‹2ç‚¹å‡»äº‹ä»¶ï¼ˆè§†é¢‘æ•™å­¦è¯¾ç¨‹ï¼‰
        document.getElementById('course2').addEventListener('click', function() {
            if (userMode === 'teacher') {
                // æ•™å¸ˆæ¨¡å¼ï¼šè·³è½¬åˆ°è¯¾ç¨‹ç¼–è¾‘é¡µé¢
                window.location.href = 'teacher_dashboard.html?action=edit&courseId=course_002';
            } else {
                // å­¦ç”Ÿæ¨¡å¼ï¼šè·³è½¬åˆ°ç»Ÿä¸€çš„è¯¾ç¨‹å­¦ä¹ é¡µé¢
                window.location.href = `course_learning.html?courseId=course_002&mode=${userMode}`;
            }
        });

        // ç¦ç”¨çš„è¯¾ç¨‹å¡ç‰‡ç‚¹å‡»æç¤º
        document.querySelectorAll('.course-card.disabled').forEach(card => {
            card.addEventListener('click', function() {
                if (userMode === 'teacher') {
                    // æ•™å¸ˆæ¨¡å¼ï¼šå¯ä»¥ç¼–è¾‘å³å°†æ¨å‡ºçš„è¯¾ç¨‹
                    const courseId = this.getAttribute('data-course-id');
                    window.location.href = `teacher_dashboard.html?action=edit&courseId=${courseId}`;
                } else {
                    alert('è¯¥è¯¾ç¨‹å³å°†æ¨å‡ºï¼Œæ•¬è¯·æœŸå¾…ï¼');
                }
            });
        });

        // æ·»åŠ è¯¾ç¨‹å¡ç‰‡ç‚¹å‡»äº‹ä»¶ï¼ˆæ•™å¸ˆæ¨¡å¼ï¼‰
        if (addCourseCard) {
            addCourseCard.addEventListener('click', function() {
                window.location.href = 'teacher_dashboard.html?action=create';
            });
        }

        // å¸ƒç½®ä½œä¸šæŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼ˆæ•™å¸ˆæ¨¡å¼ï¼‰
        if (assignHomeworkBtn) {
            assignHomeworkBtn.addEventListener('click', function() {
                window.location.href = 'teacher_dashboard.html?action=homework';
            });
        }





        // ==================== è¿”å›æŒ‰é’®åŠŸèƒ½ ====================
        const returnBtn = document.getElementById('returnBtn');
        if (returnBtn) {
            returnBtn.addEventListener('click', () => {
                window.location.href = 'qianduan.html';
            });
        }

        // ==================== ä½œä¸šæŒ‰é’®åŠŸèƒ½ ====================
        if (homeworkBtn) {
            homeworkBtn.addEventListener('click', () => {
                window.location.href = `homework_submission.html?mode=${userMode}`;
            });
        }
    </script>
</body>
</html>
